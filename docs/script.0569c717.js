parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"NRet":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ENNEMY_BODY=exports.ENNEMY_HEAD=exports.ISAAC_POWERUP=exports.ISAAC_SPRITE=exports.PILL_IMAGE=exports.COIN_IMAGE=exports.BG_IMAGE=exports.CTX=exports.SCORE_ELEMENT=exports.CANVAS_ELEMENT=void 0;var e=document.getElementById("canvas");exports.CANVAS_ELEMENT=e;var t=document.getElementById("score");exports.SCORE_ELEMENT=t;var E=canvas.getContext("2d");exports.CTX=E,E.imageSmoothingEnabled=!1;var o=document.getElementById("bgBoard");exports.BG_IMAGE=o;var r=document.getElementById("coin");exports.COIN_IMAGE=r;var n=document.getElementById("pill");exports.PILL_IMAGE=n;var s=document.getElementById("isaacSprite");exports.ISAAC_SPRITE=s;var d=document.getElementById("isaacPowerup");exports.ISAAC_POWERUP=d;var p=document.getElementById("ennemyHead");exports.ENNEMY_HEAD=p;var I=document.getElementById("ennemyBody");exports.ENNEMY_BODY=I;
},{}],"rOsU":[function(require,module,exports) {
module.exports={animationDuration:200,normalPacmanSpeed:1,normalEnnemySpeed:.9,fleeEnnemySpeed:.5,stepAnimationDuration:80,framesStep:10,spriteSize:32,tileSize:32,boardWidth:28,boardHeight:31,canvasWidth:840,canvasHeight:930,powerUpDuration:1e4,ennemiesData:[{initialCoord:[12,13],initialTarget:[13,11],scatterTarget:[1,26],spawnTimeout:2e3},{initialCoord:[13,13],initialTarget:[13,11],scatterTarget:[1,1],spawnTimeout:4e3},{initialCoord:[14,13],initialTarget:[13,11],scatterTarget:[26,1],spawnTimeout:6e3},{initialCoord:[15,13],initialTarget:[14,11],scatterTarget:[26,29],spawnTimeout:8e3}],boardArray:[["X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X"],["X",".",".",".",".",".",".",".",".",".",".",".",".","X","X",".",".",".",".",".",".",".",".",".",".",".",".","X"],["X",".","X","X","X","X",".","X","X","X","X","X",".","X","X",".","X","X","X","X","X",".","X","X","X","X",".","X"],["X","O","X","X","X","X",".","X","X","X","X","X",".","X","X",".","X","X","X","X","X",".","X","X","X","X","O","X"],["X",".","X","X","X","X",".","X","X","X","X","X",".","X","X",".","X","X","X","X","X",".","X","X","X","X",".","X"],["X",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","X"],["X",".","X","X","X","X",".","X","X",".","X","X","X","X","X","X","X","X",".","X","X",".","X","X","X","X",".","X"],["X",".","X","X","X","X",".","X","X",".","X","X","X","X","X","X","X","X",".","X","X",".","X","X","X","X",".","X"],["X",".",".",".",".",".",".","X","X",".",".",".",".","X","X",".",".",".",".","X","X",".",".",".",".",".",".","X"],["X","X","X","X","X","X",".","X","X","X","X","X",".","X","X",".","X","X","X","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X","X","X","X",".","X","X",".","X","X","X","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X",".",".",".",".",".",".",".",".",".",".","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X",".","X","X","X","-","-","X","X","X",".","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X",".","X","h","h","h","h","h","h","X",".","X","X",".","X","X","X","X","X","X"],[".",".",".",".",".",".",".",".",".",".","X","h","h","h","h","h","h","X",".",".",".",".",".",".",".",".",".","."],["X","X","X","X","X","X",".","X","X",".","X","h","h","h","h","h","h","X",".","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X",".",".",".",".",".",".",".",".",".",".","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X"],["X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X"],["X",".",".",".",".",".",".",".",".",".",".",".",".","X","X",".",".",".",".",".",".",".",".",".",".",".",".","X"],["X",".","X","X","X","X",".","X","X","X","X","X",".","X","X",".","X","X","X","X","X",".","X","X","X","X",".","X"],["X",".","X","X","X","X",".","X","X","X","X","X",".","X","X",".","X","X","X","X","X",".","X","X","X","X",".","X"],["X","O",".",".","X","X",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","X","X",".",".","O","X"],["X","X","X",".","X","X",".","X","X",".","X","X","X","X","X","X","X","X",".","X","X",".","X","X",".","X","X","X"],["X","X","X",".","X","X",".","X","X",".","X","X","X","X","X","X","X","X",".","X","X",".","X","X",".","X","X","X"],["X",".",".",".",".",".",".","X","X",".",".",".",".","X","X",".",".",".",".","X","X",".",".",".",".",".",".","X"],["X",".","X","X","X","X","X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X","X","X","X","X",".","X"],["X",".","X","X","X","X","X","X","X","X","X","X",".","X","X",".","X","X","X","X","X","X","X","X","X","X",".","X"],["X",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","X"],["X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X"]]};
},{}],"dURd":[function(require,module,exports) {
"use strict";function r(r,e){return u(r)||o(r,e)||n(r,e)||t()}function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(r,t){if(r){if("string"==typeof r)return e(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(r,t):void 0}}function e(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function o(r,t){var n=r&&("undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"]);if(null!=n){var e,o,u=[],a=!0,i=!1;try{for(n=n.call(r);!(a=(e=n.next()).done)&&(u.push(e.value),!t||u.length!==t);a=!0);}catch(c){i=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw o}}return u}}function u(r){if(Array.isArray(r))return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.modulo=s,exports.moduloCoord=f,exports.getDirectionFromCoord=d,exports.addCoord=p,exports.substractCoord=v,exports.distanceBetweenCoords=y,exports.compareArrays=h,exports.DIRECTION_MATRICES=void 0;var a=require("./data.json"),i=a.canvasWidth,c=a.canvasHeight,l={LEFT:[-1,0],RIGHT:[1,0],UP:[0,-1],DOWN:[0,1]};function s(r,t){var n=(r%t+t)%t;return n<0?n+Math.abs(t):n}function f(r){return[s(r[0],i),s(r[1],c)]}function d(t){var n=Object.entries(l).find(function(n){var e=r(n,2),o=(e[0],e[1]);return h(t,o)});if(n)return n[0]}function p(r,t){return r.map(function(r,n){return r+t[n]})}function v(r,t){return r.map(function(r,n){return r-t[n]})}function y(r,t){var n=Math.pow(r[0]-t[0],2),e=Math.pow(r[1]-t[1],2);return Math.sqrt(n+e)}function h(r,t){if((null==r?void 0:r.length)!=(null==t?void 0:t.length))return!1;for(var n=0;n<r.length;n++)if(r[n]!=t[n])return!1;return!0}exports.DIRECTION_MATRICES=l;
},{"./data.json":"rOsU"}],"zP0G":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./canvas"),t=require("./utils");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}var s=require("./data.json"),o=s.tileSize,n=function(){function t(e,r){switch(i(this,t),this.tileType="",this.coord=r,this.hasPoint=!1,this.hasSuperPoint=!1,e){case"X":this.tileType="WALL";break;case".":this.tileType="PATH",this.hasPoint=!0;break;case"O":this.tileType="PATH",this.hasSuperPoint=!0;break;case"-":this.tileType="GATE";break;case"h":this.tileType="HOME"}}return a(t,[{key:"removePoint",value:function(){this.hasPoint=!1,this.hasSuperPoint=!1}},{key:"drawTile",value:function(){if(this.hasPoint&&e.CTX.drawImage(e.COIN_IMAGE,this.coord[0]*o,this.coord[1]*o,o,o),this.hasSuperPoint){e.CTX.drawImage(e.PILL_IMAGE,this.coord[0]*o-8,this.coord[1]*o-8,o+16,o+16)}}}]),t}();exports.default=n;
},{"./canvas":"NRet","./utils":"dURd","./data.json":"rOsU"}],"GCdN":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=function(){function t(){e(this,t),this.initState()}return n(t,[{key:"initState",value:function(){this.score=0,this.gameState="START",this.board,this.pacman,this.ennemies}}]),t}(),r=new i,a={STATE:r};exports.default=a;
},{}],"C0wJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("./tile")),r=require("./canvas"),t=require("./utils"),a=i(require("./state"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function o(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,r,t){return r&&o(e.prototype,r),t&&o(e,t),e}var l=require("./data.json"),d=l.boardArray,s=l.boardArray[0].length,f=l.boardArray.length,c=l.canvasWidth,h=l.canvasHeight,v=function(){function i(){n(this,i),this.boardTiles=[],this.initBoard()}return u(i,[{key:"initBoard",value:function(){this.boardTiles=[];for(var r=0;r<f;r++){for(var t=[],a=0;a<s;a++){var i=new e.default(d[r][a],[a,r]);t.push(i)}this.boardTiles.push(t)}}},{key:"getTile",value:function(e){if(e){var r=(0,t.modulo)(e[0],s),a=(0,t.modulo)(e[1],f);return this.boardTiles[a][r]}}},{key:"drawBoard",value:function(){r.CTX.drawImage(r.BG_IMAGE,0,0,r.CANVAS_ELEMENT.width,r.CANVAS_ELEMENT.height),this.drawTiles()}},{key:"drawTiles",value:function(){this.boardTiles.forEach(function(e){e.forEach(function(e){e.drawTile()})})}},{key:"getNextTileInDirection",value:function(e,r){if(!r||!e)return!1;var i=t.DIRECTION_MATRICES[r],n=(0,t.addCoord)(i,e);return a.default.board.getTile(n)}}]),i}();exports.default=v;
},{"./tile":"zP0G","./canvas":"NRet","./utils":"dURd","./state":"GCdN","./data.json":"rOsU"}],"RWiE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("./state")),t=require("./utils");function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var s=require("./data.json"),a=s.animationDuration,u=s.normalEnnemySpeed,c=s.fleeEnnemySpeed,l=["DOWN","UP","RIGHT","LEFT"],m=function(){function n(e){i(this,n),this.init(e)}return o(n,[{key:"init",value:function(e){this.ennemy=e}},{key:"update",value:function(e){this.updateState(),this.setSpeed(),"DEAD"!==this.ennemy.state&&this.computePath()}},{key:"updateState",value:function(){switch(this.ennemy.state){case"SPAWN":(0,t.compareArrays)(this.ennemy.currentCoord,this.ennemy.targetCoord)&&(this.ennemy.targetCoord=this.ennemy.scatterCoord,this.ennemy.state="SCATTER");break;case"SCATTER":(0,t.compareArrays)(this.ennemy.currentCoord,this.ennemy.scatterCoord)&&(this.ennemy.state="CHASE")}}},{key:"setSpeed",value:function(){"FLEE"===this.ennemy.state?this.ennemy.speed=a*(1/c):this.ennemy.speed=a*(1/u)}},{key:"computePath",value:function(){var e,t=this.getPossibleTiles();t.length>1&&("CHASE"===this.ennemy.state||"FLEE"===this.ennemy.state)&&this.getTarget(),(e="FLEE"===this.ennemy.state?this.computeFarthestTileToTarget(t):this.computeNearestTileToTarget(t))&&this.setMovingCoord(e.coord)}},{key:"getPossibleTiles",value:function(){var t=this,n=this.ennemy.currentCoord;return l.filter(function(e){return e!=t.getOppositeDirection()}).map(function(t){return e.default.board.getNextTileInDirection(n,t)}).filter(function(e){return t.isTilePossible(e)})}},{key:"isTilePossible",value:function(e){return this.ennemy.justSpawned?["PATH","GATE","HOME"].includes(e.tileType):"PATH"===(null==e?void 0:e.tileType)}},{key:"computeNearestTileToTarget",value:function(e){var n=this.ennemy.targetCoord,i=null,r=null;return e.forEach(function(e){var o=(0,t.distanceBetweenCoords)(e.coord,n);(null===i||o<i)&&(i=o,r=e)}),r}},{key:"computeFarthestTileToTarget",value:function(e){var n=this.ennemy.targetCoord,i=null,r=null;return e.forEach(function(e){var o=(0,t.distanceBetweenCoords)(e.coord,n);(null===i||o>i)&&(i=o,r=e)}),r}},{key:"getTarget",value:function(){"CHASE"!==!this.ennemy.state&&(this.ennemy.justSpawned=!1,this.ennemy.targetCoord=e.default.pacman.movingCoord)}},{key:"computeDirection",value:function(){var e=(0,t.substractCoord)(this.ennemy.movingCoord,this.ennemy.currentCoord);return(0,t.getDirectionFromCoord)(e)}},{key:"getOppositeDirection",value:function(){switch(this.ennemy.direction){case"UP":return"DOWN";case"DOWN":return"UP";case"LEFT":return"RIGHT";case"RIGHT":return"LEFT";default:return""}}},{key:"setMovingCoord",value:function(e){var t=this;this.ennemy.movingCoord=e,this.ennemy.animTimestamp=(new Date).getTime(),this.ennemy.direction=this.computeDirection(),window.setTimeout(function(){t.ennemy.currentCoord=e},this.ennemy.speed)}},{key:"setFleeMode",value:function(){"DEAD"!==this.ennemy.state&&(this.ennemy.state="FLEE",this.direction="")}},{key:"cancelFleeMode",value:function(){var e=this.ennemy.state;"FLEE"===this.ennemy.state&&(this.direction="",this.ennemy.state="CHASE"),"DEAD"===this.ennemy.state&&this.ennemy.initInitialProperties(),console.log(e," => ",this.ennemy.state)}},{key:"setOppositeDirection",value:function(){this.ennemy.direction=this.getOppositeDirection()}}]),n}();exports.default=m;
},{"./data.json":"rOsU","./state":"GCdN","./utils":"dURd"}],"Gy9a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./canvas"),n=t(require("./state"));function t(e){return e&&e.__esModule?e:{default:e}}function r(e,n){return u(e)||s(e,n)||o(e,n)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,n){if(e){if("string"==typeof e)return a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,n):void 0}}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function s(e,n){var t=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=t){var r,i,o=[],a=!0,s=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==t.return||t.return()}finally{if(s)throw i}}return o}}function u(e){if(Array.isArray(e))return e}function m(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function c(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,n,t){return n&&c(e.prototype,n),t&&c(e,t),e}var h=require("./data.json"),d=h.tileSize,y=h.spriteSize,f=h.stepAnimationDuration,v=h.framesStep,p=["DOWN","RIGHT","UP","LEFT"],C=function(){function n(e){m(this,n),this.init(e)}return l(n,[{key:"init",value:function(e){this.ennemy=e,this.stepAnimationTimeStamp=null,this.stepAnimation=0}},{key:"draw",value:function(e){if(!this.characterIsOutOfScreen()&&"DEAD"!==this.ennemy.state){var n,t;this.stepAnimationTimeStamp||(this.stepAnimationTimeStamp=e);var i=r(this.getCoordToDraw(),2);n=i[0],t=i[1],this.drawOnCanvas(n,t,e)}}},{key:"characterIsOutOfScreen",value:function(){return 27===this.ennemy.movingCoord[0]&&0===this.ennemy.currentCoord[0]||0===this.ennemy.movingCoord[0]&&27===this.ennemy.currentCoord[0]}},{key:"isAnimationFinished",value:function(){return this.ennemy.currentCoord===this.ennemy.movingCoord}},{key:"getCoordToDraw",value:function(){if(this.isAnimationFinished())return this.ennemy.currentCoord;var e=this.getProgressOfAnimation(),n=this.ennemy.movingCoord[0]-this.ennemy.currentCoord[0],t=this.ennemy.movingCoord[1]-this.ennemy.currentCoord[1];return[this.ennemy.currentCoord[0]+n*e,this.ennemy.currentCoord[1]+t*e]}},{key:"incrementStepAnimation",value:function(e){this.stepAnimation++,this.stepAnimation=this.stepAnimation%v,this.stepAnimationTimeStamp=e}},{key:"getProgressOfAnimation",value:function(){return((new Date).getTime()-this.ennemy.animTimestamp)/this.ennemy.speed}},{key:"drawOnCanvas",value:function(e,n,t){t-this.stepAnimationTimeStamp>f&&this.incrementStepAnimation(t),this.drawBody(e,n),this.drawHead(e,n)}},{key:"drawBody",value:function(n,t){e.CTX.save(),n=n*d-3,t=(t-.2)*d-3;var r=0,i=this.stepAnimation,o=!1;"LEFT"!==this.ennemy.direction&&"RIGHT"!==this.ennemy.direction||(r=2),"LEFT"===this.ennemy.direction&&(o=!0),i>7&&(r++,i%=8),o&&(e.CTX.translate(n+d,t),e.CTX.scale(-1,1),n=0,t=0),e.CTX.drawImage(e.ENNEMY_BODY,i*y,r*y,d,d,n,t,d+6,d+6),e.CTX.restore()}},{key:"drawHead",value:function(n,t){var r=this;e.CTX.save(),n=n*d-3,t=(t-.6)*d-3;var i=p.findIndex(function(e){return e===r.ennemy.direction});-1===i&&(i=0);var o=!1;"LEFT"===this.ennemy.direction&&(o=!0,i=1),o&&(e.CTX.translate(n+d,t),e.CTX.scale(-1,1),n=0,t=0),e.CTX.drawImage(e.ENNEMY_HEAD,i*y,0,d,d,n,t,d+6,d+6),e.CTX.restore()}}]),n}();exports.default=C;
},{"./data.json":"rOsU","./canvas":"NRet","./state":"GCdN"}],"Dqyk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./utils"),t=n(require("./ennemyBehaviour")),i=n(require("./ennemyAnimation"));function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}var o=require("./data.json"),u=function(){function n(e){a(this,n),this.ennemyData=e,this.initPermanentProperties(),this.initInitialProperties(),this.ennemyBehaviour=new t.default(this),this.ennemyAnimation=new i.default(this)}return s(n,[{key:"initPermanentProperties",value:function(){this.beginningGameTimestamp=null}},{key:"initInitialProperties",value:function(){this.currentCoord=this.ennemyData.initialCoord,this.movingCoord=this.currentCoord,this.targetCoord=this.ennemyData.initialTarget,this.scatterCoord=this.ennemyData.scatterTarget,this.spawnTimeout=this.ennemyData.spawnTimeout,this.justSpawned=!0,this.direction="",this.userInputDirection="",this.beginningGameTimestamp=null,this.animTimestamp=null,this.state="SPAWN"}},{key:"setFleeMode",value:function(){this.ennemyBehaviour.setFleeMode()}},{key:"cancelFleeMode",value:function(){this.ennemyBehaviour.cancelFleeMode()}},{key:"canMove",value:function(e){return this.beginningGameTimestamp?e-this.beginningGameTimestamp>this.spawnTimeout:(this.beginningGameTimestamp=e,!1)}},{key:"setDirection",value:function(e){this.direction=e}},{key:"update",value:function(e){this.isAnimationFinished()&&this.canMove(e)&&this.ennemyBehaviour.update(e)}},{key:"isPacmanKilled",value:function(t){return"FLEE"!==this.state&&"DEAD"!==this.state&&(0,e.compareArrays)(t,this.currentCoord)}},{key:"isKilled",value:function(t){return"DEAD"!==this.state&&(0,e.compareArrays)(t,this.currentCoord)}},{key:"isAnimationFinished",value:function(){return this.currentCoord===this.movingCoord}},{key:"updateAnimation",value:function(){return null}},{key:"draw",value:function(e){this.ennemyAnimation.draw(e)}},{key:"setDead",value:function(){this.state="DEAD"}}]),n}();exports.default=u;
},{"./utils":"dURd","./ennemyBehaviour":"RWiE","./ennemyAnimation":"Gy9a","./data.json":"rOsU"}],"KNzD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./state"));function t(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}var o=require("./data.json"),r=o.animationDuration,s=o.normalPacmanSpeed,c=o.powerUpDuration,u=function(){function t(e){n(this,t),this.init(e)}return a(t,[{key:"init",value:function(e){this.pacman=e}},{key:"update",value:function(){this.processTile(),this.setSpeed();var e=this.computePathPacman();e?this.setMovingCoord(e.coord):this.pacman.direction=""}},{key:"setSpeed",value:function(){this.pacman.speed=r*(1/s)}},{key:"processTile",value:function(){var t=e.default.board.getTile(this.pacman.currentCoord);t.hasSuperPoint&&this.startPowerUp(),(t.hasPoint||t.hasSuperPoint)&&(this.addScore(10),t.removePoint())}},{key:"addScore",value:function(t){this.pacman.setScore(e.default.score+t)}},{key:"startPowerUp",value:function(){this.pacman.state="POWERUP",e.default.ennemies.forEach(function(e){e.setFleeMode()}),clearTimeout(this.pacman.powerupTimeout),this.pacman.powerupTimeout=setTimeout(this.resetPowerUp.bind(this),c)}},{key:"resetPowerUp",value:function(){console.log("resetPowerup"),"POWERUP"===this.pacman.state&&(this.pacman.state="NORMAL",e.default.ennemies.forEach(function(e,t){console.log("ennemy =>",t),e.cancelFleeMode()}))}},{key:"computePathPacman",value:function(){if(this.pacman.direction||this.isUserInputValid()){var t=e.default.board.getNextTileInDirection(this.pacman.currentCoord,this.pacman.userInputDirection);if("PATH"===(null==t?void 0:t.tileType))return this.confirmUserDirection(),t;var n=e.default.board.getNextTileInDirection(this.pacman.currentCoord,this.pacman.direction);return"PATH"===(null==n?void 0:n.tileType)?(this.setMovingCoord(n.coord),n):void 0}}},{key:"setMovingCoord",value:function(e){var t=this;this.pacman.movingCoord=e,this.pacman.animTimestamp=(new Date).getTime(),window.setTimeout(function(){t.pacman.currentCoord=e},this.pacman.speed)}},{key:"isUserInputValid",value:function(){return(new Date).getTime()-this.pacman.inputTimestamp>2e3?null:this.pacman.userInputDirection}},{key:"confirmUserDirection",value:function(){this.pacman.direction=this.pacman.userInputDirection}}]),t}();exports.default=u;
},{"./data.json":"rOsU","./state":"GCdN"}],"wDgG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("./canvas"),e=a(require("./state"));function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){return c(t)||s(t,e)||r(t,e)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,e){if(t){if("string"==typeof t)return o(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function s(t,e){var a=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=a){var n,i,r=[],o=!0,s=!1;try{for(a=a.call(t);!(o=(n=a.next()).done)&&(r.push(n.value),!e||r.length!==e);o=!0);}catch(c){s=!0,i=c}finally{try{o||null==a.return||a.return()}finally{if(s)throw i}}return r}}function c(t){if(Array.isArray(t))return t}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,a){return e&&u(t.prototype,e),a&&u(t,a),t}var p=require("./data.json"),l=p.tileSize,d=p.spriteSize,f=p.stepAnimationDuration,A=p.framesStep,v=function(){function e(t){m(this,e),this.init(t)}return h(e,[{key:"init",value:function(t){this.pacman=t,this.stepAnimationTimeStamp=null,this.stepAnimation=0,this.speed=0,this.isFrameAfterDeath=!1}},{key:"draw",value:function(t){if(!this.characterIsOutOfScreen()){var e,a;"DEAD"!==this.pacman.state||this.isFrameAfterDeath||(this.isFrameAfterDeath=!0,this.resetAnimation(t)),this.stepAnimationTimeStamp||(this.stepAnimationTimeStamp=t);var i=n(this.getCoordToDraw(),2);e=i[0],a=i[1],this.drawOnCanvas(e,a,t)}}},{key:"resetAnimation",value:function(t){this.stepAnimation=0,this.stepAnimationTimeStamp=t}},{key:"characterIsOutOfScreen",value:function(){return 27===this.pacman.movingCoord[0]&&0===this.pacman.currentCoord[0]||0===this.pacman.movingCoord[0]&&27===this.pacman.currentCoord[0]}},{key:"getCoordToDraw",value:function(){var t,e;if(this.pacman.direction&&"DEAD"!==this.pacman.state){var a=this.getProgressOfAnimation(),n=this.pacman.movingCoord[0]-this.pacman.currentCoord[0],i=this.pacman.movingCoord[1]-this.pacman.currentCoord[1];t=this.pacman.currentCoord[0]+n*a,e=this.pacman.currentCoord[1]+i*a}else t=this.pacman.currentCoord[0],e=this.pacman.currentCoord[1];return[t,e]}},{key:"incrementStepAnimation",value:function(t){"DEAD"===this.pacman.state&&this.stepAnimation>2?(this.stepAnimation=3,this.stepAnimationTimeStamp=t):(this.stepAnimation++,this.stepAnimation=this.stepAnimation%A,this.stepAnimationTimeStamp=t)}},{key:"getProgressOfAnimation",value:function(){return((new Date).getTime()-this.pacman.animTimestamp)/this.pacman.speed}},{key:"drawOnCanvas",value:function(t,e,a){a-this.stepAnimationTimeStamp>f&&this.incrementStepAnimation(a),"DEAD"===this.pacman.state?this.drawDeath(t,e):(this.drawBody(t,e),"POWERUP"===this.pacman.state?this.drawHeadPowerup(t,e):this.drawHead(t,e))}},{key:"drawDeath",value:function(e,a){var n=[{x:0,y:3},{x:0,y:4},{x:2,y:3},{x:3,y:2}];t.CTX.save();var i=e*l-16,r=(a-.5)*l-16;t.CTX.drawImage(t.ISAAC_SPRITE,n[this.stepAnimation].x*d*2+6,n[this.stepAnimation].y*d*2+9,2*l-12,2*l-12,i,r,2*l,2*l),t.CTX.restore()}},{key:"drawBody",value:function(e,a){t.CTX.save(),e=e*l-3,a=(a-.1)*l-3;var n=0,i=this.stepAnimation,r=7,o=!1;"LEFT"!==this.pacman.direction&&"RIGHT"!==this.pacman.direction||(n=2,r=0),"LEFT"===this.pacman.direction&&(o=!0),(i+=r)>=8&&(n++,i%=8),o&&(t.CTX.translate(e+l,a),t.CTX.scale(-1,1),e=0,a=0),t.CTX.drawImage(t.ISAAC_SPRITE,i*d,n*d,l,l,e,a,l+6,l+6),t.CTX.restore()}},{key:"drawHead",value:function(e,a){t.CTX.save(),e=e*l-3,a=(a-.5)*l-3;var n=this.stepAnimation>=8?1:0,i=!1,r=0;"UP"===this.pacman.direction&&(r=4),"RIGHT"===this.pacman.direction&&(r=2),"LEFT"===this.pacman.direction&&(r=2,i=!0),n+=r,i&&(t.CTX.translate(e+l,a),t.CTX.scale(-1,1),e=0,a=0),t.CTX.drawImage(t.ISAAC_SPRITE,n*d,0,l,l,e,a,l+6,l+6),t.CTX.restore()}},{key:"drawHeadPowerup",value:function(e,a){t.CTX.save();var n=e*l-d/2,i=(a-.6)*l-d/2,r=this.stepAnimation>4?1:this.stepAnimation,o=!1;"LEFT"===this.pacman.direction&&(o=!0),o&&(t.CTX.translate(n+1.85*d,i),t.CTX.scale(-1,1),n=0,i=0),console.log(r*d),t.CTX.drawImage(t.ISAAC_POWERUP,r*d*2+4,0,2*l-8,2*l-8,n,i,2*l+0,2*l+0),t.CTX.restore()}}]),e}();exports.default=v;
},{"./data.json":"rOsU","./canvas":"NRet","./state":"GCdN"}],"fnOe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./canvas"),t=a(require("./pacmanBehaviour")),i=a(require("./pacmanAnimation")),n=a(require("./state"));function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),e}var s=function(){function a(e){r(this,a),this.init(e),this.pacmanBehaviour=new t.default(this),this.pacmanAnimation=new i.default(this)}return o(a,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[1,14];this.currentCoord=e,this.movingCoord=e,this.direction="",this.userInputDirection="",this.inputTimestamp=null,this.powerupTimeout,this.state="NORMAL"}},{key:"update",value:function(){this.isAnimationFinished()&&this.pacmanBehaviour.update()}},{key:"setScore",value:function(t){n.default.score=t,e.SCORE_ELEMENT.textContent=n.default.score}},{key:"setUserInputDirection",value:function(e){this.userInputDirection=e,this.inputTimestamp=(new Date).getTime()}},{key:"isAnimationFinished",value:function(){return this.currentCoord===this.movingCoord}},{key:"setDead",value:function(){this.state="DEAD"}},{key:"draw",value:function(e){this.pacmanAnimation.draw(e)}}]),a}();exports.default=s;
},{"./canvas":"NRet","./pacmanBehaviour":"KNzD","./pacmanAnimation":"wDgG","./state":"GCdN"}],"ZxoE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("./board")),n=require("./canvas"),t=u(require("./ennemy")),a=u(require("./pacman")),i=u(require("./state"));function u(e){return e&&e.__esModule?e:{default:e}}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function d(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,n,t){return n&&d(e.prototype,n),t&&d(e,t),e}var o=require("./data.json"),s=o.ennemiesData,f=function(){function u(){r(this,u),i.default.score=0,i.default.gameState="START",this.initGame()}return l(u,[{key:"initGame",value:function(){i.default.board=new e.default,i.default.pacman=new a.default,i.default.ennemies=this.initEnnemies(),i.default.gameState="START",this.draw()}},{key:"startGameLoop",value:function(){this.bindEventHandler(),window.requestAnimationFrame(this.loop.bind(this))}},{key:"loop",value:function(e){var n=e-this.lastRender;this.lastRender=e,this.draw(n,e),this.update(n,e),window.requestAnimationFrame(this.loop.bind(this))}},{key:"update",value:function(e,n){this.updateGameState(),"END"!==i.default.gameState&&(i.default.pacman.update(),this.updateEnnemies(n))}},{key:"updateGameState",value:function(){"POWERUP"===i.default.pacman.state&&this.killTouchedEnnemies(),this.isPacmanDead()&&(i.default.pacman.setDead(),i.default.gameState="END")}},{key:"killTouchedEnnemies",value:function(){for(var e=0;e<i.default.ennemies.length;e++){var n=i.default.ennemies[e];n.isKilled(i.default.pacman.currentCoord)&&n.setDead()}}},{key:"isPacmanDead",value:function(){var e=!1;e:for(var n=0;n<i.default.ennemies.length;n++){if(i.default.ennemies[n].isPacmanKilled(i.default.pacman.currentCoord)){e=!0;break e}}return e}},{key:"draw",value:function(e,t){n.CTX.fillStyle="#2c2a2a",n.CTX.fillRect(0,0,n.CANVAS_ELEMENT.width,n.CANVAS_ELEMENT.height),i.default.board.drawBoard(),this.drawEnnemies(t),i.default.pacman.draw(t)}},{key:"initEnnemies",value:function(){var e=[];return s.forEach(function(n){e.push(new t.default(n))}),e}},{key:"updateEnnemies",value:function(e){i.default.ennemies.forEach(function(n){n.update(e)})}},{key:"drawEnnemies",value:function(e){i.default.ennemies.forEach(function(n){n.draw(e)})}},{key:"bindEventHandler",value:function(){document.addEventListener("keydown",this.keydownEventHandler.bind(this))}},{key:"unbindEventHandler",value:function(){document.removeEventListener("keydown",this.keydownEventHandler)}},{key:"keydownEventHandler",value:function(e){var n=e.which;37!==n&&81!==n||(i.default.pacman.setUserInputDirection("LEFT"),e.preventDefault()),39!==n&&68!==n||(i.default.pacman.setUserInputDirection("RIGHT"),e.preventDefault()),38!==n&&90!==n||(i.default.pacman.setUserInputDirection("UP"),e.preventDefault()),40!==n&&83!==n||(i.default.pacman.setUserInputDirection("DOWN"),e.preventDefault())}}]),u}();exports.default=f;
},{"./board":"C0wJ","./canvas":"NRet","./ennemy":"Dqyk","./pacman":"fnOe","./state":"GCdN","./data.json":"rOsU"}],"fWRU":[function(require,module,exports) {
"use strict";var e=t(require("./game"));function t(e){return e&&e.__esModule?e:{default:e}}function n(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}n(function(){var t=new e.default;t.initGame(),t.startGameLoop()});
},{"./game":"ZxoE"}]},{},["fWRU"], null)
//# sourceMappingURL=script.0569c717.js.map