{"version":3,"sources":["script/canvas.js","script/data.json","script/utils.js","script/tile.js","script/board.js","script/ghost.js","script/pacman.js","script/game.js","script/index.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["CANVAS_ELEMENT","document","getElementById","CTX","canvas","getContext","imageSmoothingEnabled","BG_IMAGE","COIN_IMAGE","PILL_IMAGE","ISAAC_SPRITE","BONEY_HEAD","BONEY_BODY","module","exports","gameData","require","CANVAS_WIDTH","canvasWidth","CANVAS_HEIGHT","canvasHeight","DIRECTION_MATRICES","modulo","n","m","mod","Math","abs","moduloCoord","coord","getDirectionFromCoord","directionObject","Object","entries","find","direction","directionCoord","compareArrays","addCoord","coord1","coord2","map","value","index","substractCoord","distanceBetweenCoords","part1","pow","part2","sqrt","a","b","length","i","TILE_SIZE","tileSize","Tile","initialData","tileType","hasPoint","hasSuperPoint","drawImage","incrementConst","BOARD_ARRAY","boardArray","BOARD_WIDTH","BOARD_HEIGHT","Board","boardTiles","initBoard","y","line","x","tile","push","coordX","coordY","width","height","drawTiles","forEach","row","drawTile","SPRITE_SIZE","spriteSize","ANIMATION_DURATION","animationDuration","STEP_DURATION","stepAnimationDuration","FRAMES_STEP","framesStep","DIRECTIONS","Boney","init","ennemyData","currentCoord","initialCoord","movingCoord","targetCoord","initialTarget","scatterCoord","scatterTarget","spawnTimeout","justSpawned","userInputDirection","beginningGameTimestamp","animTimestamp","stepAnimationTimeStamp","stepAnimation","state","timestamp","Date","getTime","computeDirection","window","setTimeout","includes","characterIsOutOfScreen","getCoordToDraw","drawOnCanvas","isAnimationFinished","animationProgress","getProgressOfAnimation","deltaX","deltaY","currentStepDuration","incrementStepAnimation","drawBody","drawHead","save","spriteIndex","isReversed","translate","scale","restore","findIndex","currentTimeStamp","Pacman","inputTimestamp","timeSinceLastInput","stepAnimationShift","stepAnimationModulo","ENNEMIES_DATA","ennemiesData","Game","scoreElement","score","gameState","initGame","board","pacman","boneys","initEnnemies","draw","bindEventHandler","requestAnimationFrame","loop","bind","progress","lastRender","update","updatePacman","updateEnnemies","fillStyle","fillRect","drawBoard","drawEnnemies","addPointOfCurrentPacmanTile","nextTile","computePathPacman","setMovingCoord","isUserInputValid","nextTileUserDirection","getNextTileInDirection","confirmUserDirection","nextTileCurrentDirection","boney","updateEnnemy","ennemy","canMove","updateState","possibleTiles","getEnnemyPossibleTiles","getTarget","tileToMove","computeNearestTileToTarget","possibleDirections","filter","dir","getOppositeDirection","adjacentTiles","isTilePossible","closestDistance","closestTile","distance","directionMatrice","coordToMove","getTile","currentTile","addScore","removePoint","textContent","addEventListener","keydownEventHandler","removeEventListener","event","keycode","which","setUserInputDirection","preventDefault","docReady","fn","readyState","game","startGameLoop","OVERLAY_ID","OldModule","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"script.7c337ef3.js","sourceRoot":"..","sourcesContent":["export const CANVAS_ELEMENT = document.getElementById(\"canvas\");\nexport const CTX = canvas.getContext(\"2d\");\nCTX.imageSmoothingEnabled = false;\n\nexport const BG_IMAGE = document.getElementById(\"bgBoard\");\nexport const COIN_IMAGE = document.getElementById(\"coin\");\nexport const PILL_IMAGE = document.getElementById(\"pill\");\nexport const ISAAC_SPRITE = document.getElementById(\"isaacSprite\");\nexport const BONEY_HEAD = document.getElementById(\"boneyHead\");\nexport const BONEY_BODY = document.getElementById(\"boneyBody\");\n","module.exports = {\n    \"animationDuration\": 200,\n    \"stepAnimationDuration\": 50,\n    \"framesStep\": 10,\n    \"spriteSize\": 32,\n    \"tileSize\": 32,\n    \"boardWidth\": 28,\n    \"boardHeight\": 31,\n    \"canvasWidth\": 840,\n    \"canvasHeight\": 930,\n    \"ennemiesData\":[\n        {\n            \"initialCoord\" : [12,13],\n            \"initialTarget\" : [13,11],\n            \"scatterTarget\" : [1,26],\n            \"spawnTimeout\" : 2000\n        },\n        {\n            \"initialCoord\" : [13,13],\n            \"initialTarget\" : [13,11],\n            \"scatterTarget\" : [1,1],\n            \"spawnTimeout\" : 4000\n        },\n        {\n            \"initialCoord\" : [14,13],\n            \"initialTarget\" : [13,11],\n            \"scatterTarget\" : [26,1],\n            \"spawnTimeout\" : 6000\n        }, \n       \n        {\n            \"initialCoord\" : [15,13],\n            \"initialTarget\" : [14,11],\n            \"scatterTarget\" : [26,29],\n            \"spawnTimeout\" : 8000\n        }\n    ],\n    \"boardArray\": [\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \"O\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"O\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"-\", \"-\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"h\", \"h\", \"h\", \"h\", \"h\", \"h\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"h\", \"h\", \"h\", \"h\", \"h\", \"h\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"h\", \"h\", \"h\", \"h\", \"h\", \"h\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"],\n        [\"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \"O\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \"O\", \"X\"],\n        [\"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\"],\n        [\"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\"],\n        [\"X\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \"X\", \"X\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\", \"X\", \".\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \".\", \"X\"],\n        [\"X\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \"X\"],\n        [\"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\", \"X\"]\n    ]\n};","let gameData = require(\"./data.json\");\nconst CANVAS_WIDTH = gameData.canvasWidth;\nconst CANVAS_HEIGHT = gameData.canvasHeight;\n\n\nexport const DIRECTION_MATRICES = {\n    'LEFT' : [-1, 0],\n    'RIGHT' : [1, 0],\n    'UP' : [0, -1],\n    'DOWN' : [0, 1]\n\n}\n\nexport function modulo(n, m) {\n    var mod = ((n % m) + m) % m;\n    return mod < 0 ? mod + Math.abs(m) : mod;\n};\n\nexport function moduloCoord(coord) {\n    return [modulo(coord[0], CANVAS_WIDTH), modulo(coord[1], CANVAS_HEIGHT)]\n};\n\nexport function getDirectionFromCoord(coord){\n    const directionObject = Object.entries(DIRECTION_MATRICES).find(([direction, directionCoord])=>{\n        return compareArrays(coord, directionCoord);\n    });\n    if (directionObject) {\n    return directionObject[0];\n    }    \n}\n    \n\nexport function addCoord(coord1, coord2) {\n    return coord1.map((value, index) => value += coord2[index]);\n};\n\nexport function substractCoord(coord1, coord2) {\n    return coord1.map((value, index) => value -= coord2[index]);\n};\n\nexport function distanceBetweenCoords(coord1, coord2) {\n    let part1 = Math.pow(coord1[0] - coord2[0], 2);\n    let part2 = Math.pow(coord1[1] - coord2[1], 2);\n    return Math.sqrt(part1 + part2);\n};\n\nexport function compareArrays(a, b){\n  // if length is not equal\n  if(a?.length != b?.length)   return false;\n\n  // comapring each element of array\n   for(var i=0;i<a.length;i++){\n   if(a[i]!=b[i]) return false;\n   }\n    return true;\n  }","import { CTX, COIN_IMAGE, PILL_IMAGE } from \"./canvas\";\nimport {compareArrays} from \"./utils\";\n\nlet gameData = require(\"./data.json\");\nconst TILE_SIZE = gameData.tileSize;\nexport default class Tile {\n  constructor(initialData, coord) {\n    //possible tileType : 'PATH', 'WALL', 'GATE', 'HOME'\n    this.tileType = \"\";\n    this.coord = coord;\n    this.hasPoint = false;\n    this.hasSuperPoint = false;\n\n    switch (initialData) {\n      case \"X\":\n        this.tileType = \"WALL\";\n        break;\n      case \".\":\n        this.tileType = \"PATH\";\n        this.hasPoint = true;\n        break;\n      case \"O\":\n        this.tileType = \"PATH\";\n        this.hasSuperPoint = true;\n        break;\n      case \"-\":\n        this.tileType = \"GATE\";\n        break;\n      case \"h\":\n        this.tileType = \"HOME\";\n        break;\n      default:\n        break;\n    }\n  }\n\n  removePoint() {\n    this.hasPoint = false;\n    this.hasSuperPoint = false;\n  }\n\n  drawTile() {\n    if (this.hasPoint) {\n    CTX.drawImage(\n      COIN_IMAGE,\n      this.coord[0] * TILE_SIZE,\n      this.coord[1] * TILE_SIZE,\n      TILE_SIZE,\n      TILE_SIZE\n    );\n    }\n\n    if (this.hasSuperPoint) {\n      const incrementConst = 16;\n\n      CTX.drawImage(\n        PILL_IMAGE,\n        this.coord[0] * TILE_SIZE - incrementConst/2,\n        this.coord[1] * TILE_SIZE - incrementConst/2,\n        TILE_SIZE + incrementConst,\n        TILE_SIZE + incrementConst\n      );\n      }\n    }\n  }\n\n","import Tile from \"./tile\";\nimport { CANVAS_ELEMENT, CTX, BG_IMAGE } from \"./canvas\";\nimport { modulo } from \"./utils\";\n\nlet gameData = require(\"./data.json\");\nconst BOARD_ARRAY = gameData.boardArray;\nconst BOARD_WIDTH = gameData.boardArray[0].length;\nconst BOARD_HEIGHT = gameData.boardArray.length;\nconst CANVAS_WIDTH = gameData.canvasWidth;\nconst CANVAS_HEIGHT = gameData.canvasHeight;\n\nexport default class Board {\n  constructor() {\n    this.boardTiles = [];\n    this.initBoard();\n  }\n\n  initBoard() {\n    this.boardTiles = [];\n    for (let y = 0; y < BOARD_HEIGHT; y++) {\n      let line = [];\n      for (let x = 0; x < BOARD_WIDTH; x++) {\n        let tile = new Tile(BOARD_ARRAY[y][x], [x, y]);\n        line.push(tile);\n      }\n      this.boardTiles.push(line);\n    }\n  }\n\n  getTile(coord) {\n    if (coord) {\n      let coordX = modulo(coord[0], BOARD_WIDTH);\n      let coordY = modulo(coord[1], BOARD_HEIGHT);\n      return this.boardTiles[coordY][coordX];\n    }\n  }\n\n  drawBoard() {\n    CTX.drawImage(BG_IMAGE, 0, 0, CANVAS_ELEMENT.width, CANVAS_ELEMENT.height);\n    this.drawTiles();\n  }\n\n  drawTiles() {\n    this.boardTiles.forEach((row) => {\n      row.forEach((tile) => {\n        tile.drawTile();\n      });\n    });\n  }\n}\n","import {\n  CTX,\n  BONEY_HEAD,\n  BONEY_BODY\n} from \"./canvas\";\n\nimport {\n  getDirectionFromCoord,\n  compareArrays,\n  substractCoord\n} from \"./utils\";\n\nconst gameData = require(\"./data.json\");\nconst TILE_SIZE = gameData.tileSize;\nconst SPRITE_SIZE = gameData.spriteSize;\nconst ANIMATION_DURATION = gameData.animationDuration;\nconst STEP_DURATION = gameData.stepAnimationDuration;\nconst FRAMES_STEP = gameData.framesStep;\nconst DIRECTIONS = ['DOWN', 'RIGHT', 'UP', 'LEFT'];\n\n//STATE : SPAWN, SCATTER, CHASE\nexport default class Boney {\n  constructor(coord) {\n    this.init(coord);\n  }\n\n  init(ennemyData) {\n    this.ennemyData = ennemyData;\n    // Actual coord\n    this.currentCoord = ennemyData.initialCoord;\n\n    // Coord where the pacman is moving to\n    this.movingCoord = this.currentCoord;\n\n    // Position of the gate to move to\n    this.targetCoord = ennemyData.initialTarget;\n    this.scatterCoord = ennemyData.scatterTarget;\n    this.spawnTimeout = ennemyData.spawnTimeout;\n    this.justSpawned = true;\n\n    // Timestamp fo the start of the animation\n    this.direction = \"\";\n    this.userInputDirection = \"\";\n\n\n    this.beginningGameTimestamp = null;\n    this.animTimestamp = null;\n    this.stepAnimationTimeStamp = null;\n    this.stepAnimation = 0;\n\n    this.state = 'SPAWN';\n  }\n\n  canMove(timestamp) {\n    if (!this.beginningGameTimestamp) {\n      this.beginningGameTimestamp = timestamp;\n      return false;\n    }\n\n    return (timestamp - this.beginningGameTimestamp) > this.spawnTimeout;\n  }\n\n  setDirection(direction) {\n    this.direction = direction;\n  }\n\n  getOppositeDirection(){\n    switch (this.direction){\n      case 'UP':\n        return 'DOWN';\n        break;\n      case 'DOWN':\n        return 'UP';\n        break;\n      case 'LEFT':\n        return 'RIGHT';\n        break;\n      case 'RIGHT':\n        return 'LEFT';\n        break;\n      default:\n        return null;\n    }\n\n  }\n\n  setMovingCoord(coord) {\n    this.movingCoord = coord;\n    this.animTimestamp = new Date().getTime();\n    this.direction = this.computeDirection();\n    window.setTimeout(() => {\n      this.currentCoord = coord;\n    }, ANIMATION_DURATION);\n  }\n\n  updateState() {\n    switch (this.state) {\n      case 'SPAWN':\n        if (compareArrays(this.currentCoord, this.targetCoord)) {\n          this.targetCoord = this.scatterCoord;\n          this.state = 'SCATTER'\n        };\n        break;\n      case 'SCATTER':\n        if (compareArrays(this.currentCoord, this.scatterCoord)) {\n          this.state = 'CHASE'\n        };\n        break;\n      case 'CHASE':\n        break;\n    }\n  }\n\n  computeDirection() {\n    const directionCoord = substractCoord(this.movingCoord, this.currentCoord);\n    return getDirectionFromCoord(directionCoord);\n  }\n\n  isAnimationFinished() {\n    return this.currentCoord === this.movingCoord;\n  }\n\n  isTargetReached() {\n    return this.currentCoord === this.currentCoord;\n  }\n\n  isTilePossible(tile) {\n    if (this.justSpawned) {\n      return ['PATH', 'GATE', 'HOME'].includes(tile.tileType);\n    }\n    return tile ?.tileType === \"PATH\";\n  }\n\n  updateAnimation() {\n    return null;\n  }\n\n  draw(timestamp) {\n    if (this.characterIsOutOfScreen()) {\n      return;\n    }\n    if(!this.stepAnimationTimeStamp){\n      this.stepAnimationTimeStamp = timestamp;\n    }\n    let x, y;\n    [x, y] = this.getCoordToDraw();\n    this.drawOnCanvas(x, y, timestamp);\n  }\n\n\n  characterIsOutOfScreen() {\n    if (this.movingCoord[0] === 27 && this.currentCoord[0] === 0) {\n      return true;\n    }\n    if (this.movingCoord[0] === 0 && this.currentCoord[0] === 27) {\n      return true;\n    }\n    return false;\n  }\n\n  getCoordToDraw() {\n    let x, y;\n    if (this.isAnimationFinished()) {\n      return this.currentCoord;\n    }\n    // Get the percentage of progress of the anim\n    let animationProgress = this.getProgressOfAnimation();\n\n    //Delta of the current tile and target tiles\n    let deltaX = this.movingCoord[0] - this.currentCoord[0];\n    let deltaY = this.movingCoord[1] - this.currentCoord[1];\n\n    // Position based on the progress of the animation\n    x = this.currentCoord[0] + deltaX * animationProgress;\n    y = this.currentCoord[1] + deltaY * animationProgress;\n\n    // Setting the position of the pacman\n    return [x, y];\n  }\n\n  drawOnCanvas(x, y, timestamp) {\n    let currentStepDuration = timestamp - this.stepAnimationTimeStamp;\n    if(currentStepDuration > STEP_DURATION){\n      this.incrementStepAnimation(timestamp);\n    }\n    this.drawBody(x, y);\n    this.drawHead(x, y);\n  }\n\n  drawBody(x, y){\n    const incrementConst = 6;\n\n    CTX.save();\n\n    x = x * TILE_SIZE - incrementConst / 2;\n    y = (y - 0.2) * TILE_SIZE - incrementConst / 2;\n\n    let spriteIndex = 0;\n    let stepAnimation = this.stepAnimation;\n    let isReversed = false;\n\n    if(this.direction === 'LEFT' || this.direction === 'RIGHT'){\n      spriteIndex = 2;\n    }\n\n    if (this.direction === 'LEFT') {\n      isReversed = true;\n    }\n\n    if(stepAnimation > 7){\n      spriteIndex++;\n      stepAnimation = stepAnimation % 8;\n    }\n\n    if (isReversed) {\n      CTX.translate( x + TILE_SIZE, y);\n      CTX.scale(-1, 1);\n      x = 0;\n      y= 0\n    }\n\n    CTX.drawImage(\n      BONEY_BODY,\n      stepAnimation * SPRITE_SIZE,\n      spriteIndex * SPRITE_SIZE,\n      TILE_SIZE,\n      TILE_SIZE,\n      x,\n      y,\n      TILE_SIZE + incrementConst,\n      TILE_SIZE + incrementConst,\n    );\n\n    CTX.restore();\n\n  }\n\n  drawHead(x, y) {\n    const incrementConst = 6;\n\n    CTX.save();\n\n    x = x * TILE_SIZE - incrementConst / 2;\n    y = (y - 0.6) * TILE_SIZE - incrementConst / 2;\n\n      let spriteIndex = DIRECTIONS.findIndex((direction) => direction === this.direction);\n    if (spriteIndex === -1) spriteIndex = 0;\n    let isReversed = false;\n    if (this.direction === 'LEFT') {\n      isReversed = true;\n      spriteIndex = 1;\n    }\n\n    if (isReversed) {\n      CTX.translate( x + TILE_SIZE, y);\n      CTX.scale(-1, 1);\n      x = 0;\n      y= 0\n    }\n\n    CTX.drawImage(\n      BONEY_HEAD,\n      spriteIndex * SPRITE_SIZE,\n      0,\n      TILE_SIZE,\n      TILE_SIZE,\n      x,\n      y,\n      TILE_SIZE + incrementConst,\n      TILE_SIZE + incrementConst,\n    );\n\n    CTX.restore();\n  }\n\n  incrementStepAnimation(timestamp){\n    this.stepAnimation++;\n    this.stepAnimation = this.stepAnimation % FRAMES_STEP;\n    this.stepAnimationTimeStamp = timestamp;\n  }\n\n  getProgressOfAnimation() {\n    let currentTimeStamp = new Date().getTime();\n    return (currentTimeStamp - this.animTimestamp) / ANIMATION_DURATION;\n  }\n}","import { CTX, ISAAC_SPRITE } from \"./canvas\";\n\nconst gameData = require(\"./data.json\");\nconst TILE_SIZE = gameData.tileSize;\nconst SPRITE_SIZE = gameData.spriteSize;\nconst ANIMATION_DURATION = gameData.animationDuration;\nconst STEP_DURATION = gameData.stepAnimationDuration;\nconst FRAMES_STEP = gameData.framesStep;\nexport default class Pacman {\n  constructor(coord) {\n    this.init(coord);\n  }\n\n  init(coord = [1, 14]) {\n    // Actual coord of the pacman\n  this.currentCoord = coord;\n\n    // Coord where the pacman is moving to\n  this.movingCoord = coord;\n\n    // Possible state : IDLE, MOVING, DEAD\n    this.state = \"IDLE\";\n\n    // Timestamp fo the start of the animation\n    this.animTimestamp = null;\n    this.direction = \"\";\n    this.stepAnimationTimeStamp = null;\n    this.stepAnimation = 0;\n    this.userInputDirection = \"\";\n    this.inputTimestamp = null;\n  }\n\n  setUserInputDirection(direction) {\n    this.userInputDirection = direction;\n    this.inputTimestamp = new Date().getTime();\n  }\n\n  isUserInputValid(){\n    let timeSinceLastInput = new Date().getTime() - this.inputTimestamp;\n    if(timeSinceLastInput > 2000) return null;\n    return this.userInputDirection;\n  }\n\n  confirmUserDirection() {\n    this.direction = this.userInputDirection;\n    // this.changePacmanSprite();\n  }\n\n  setDirection(direction) {\n    this.direction = direction;\n  }\n\n  setMovingCoord(coord) {\n    this.state = \"MOVING\";\n    this.movingCoord = coord;\n    this.animTimestamp = new Date().getTime();\n    window.setTimeout(() => {\n      this.currentCoord = coord;\n    }, ANIMATION_DURATION);\n  }\n\n  isAnimationFinished() {\n    return this.currentCoord === this.movingCoord;\n  }\n\n  updateAnimation() {\n    return null;\n  }\n\n  draw(timestamp) {\n    if (this.characterIsOutOfScreen()) {\n      return;\n    }\n    if(!this.stepAnimationTimeStamp){\n      this.stepAnimationTimeStamp = timestamp;\n    }\n    let x, y;\n    [x, y] = this.getCoordToDraw();\n    this.drawOnCanvas(x, y, timestamp);\n  }\n\n  characterIsOutOfScreen() {\n    if (this.movingCoord[0] === 27 && this.currentCoord[0] === 0) {\n      return true;\n    }\n    if (this.movingCoord[0] === 0 && this.currentCoord[0] === 27) {\n      return true;\n    }\n    return false;\n  }\n\n  getCoordToDraw(){\n    let x,y;\n    if (this.state === \"MOVING\") {\n      // Get the percentage of progress of the anim\n      let animationProgress = this.getProgressOfAnimation();\n      //Delta of the current tile and target tiles\n      let deltaX = this.movingCoord[0] - this.currentCoord[0];\n      let deltaY = this.movingCoord[1] - this.currentCoord[1];\n\n      // Position based on the progress of the animation\n      x = this.currentCoord[0] + deltaX * animationProgress;\n      y = this.currentCoord[1] + deltaY * animationProgress;\n\n      // Setting the position of the pacman\n    }\n    if (this.state === \"IDLE\") {\n      // If idle, set the pacman at the position of the tile\n      x = this.currentCoord[0];\n      y = this.currentCoord[1];\n    }\n    return[x,y];\n  }\n\n  drawOnCanvas(x, y, timestamp) {\n    let currentStepDuration = timestamp - this.stepAnimationTimeStamp;\n    if(currentStepDuration > STEP_DURATION){\n      this.incrementStepAnimation(timestamp);\n    }\n\n    this.drawBody(x, y);\n    this.drawHead(x, y);\n  }\n\n\n  drawBody(x, y){\n    const incrementConst = 6;\n\n    CTX.save();\n\n    x = x * TILE_SIZE - incrementConst / 2;\n    y = (y - 0.1) * TILE_SIZE - incrementConst / 2;\n\n    let spriteIndex = 0;\n    let stepAnimation = this.stepAnimation;\n    let stepAnimationShift = 7;\n    let stepAnimationModulo = 8;\n    let isReversed = false;\n\n    if(this.direction === 'LEFT' || this.direction === 'RIGHT'){\n      spriteIndex = 2;\n      stepAnimationShift = 0;\n\n    }\n\n    if (this.direction === 'LEFT') {\n      isReversed = true;\n    }\n\n    stepAnimation += stepAnimationShift;\n\n    if(stepAnimation >= stepAnimationModulo){\n      spriteIndex++;\n      stepAnimation = stepAnimation % stepAnimationModulo;\n    }\n\n    if (isReversed) {\n      CTX.translate( x + TILE_SIZE, y);\n      CTX.scale(-1, 1);\n      x = 0;\n      y= 0\n    }\n\n    CTX.drawImage(\n      ISAAC_SPRITE,\n      stepAnimation * SPRITE_SIZE,\n      spriteIndex * SPRITE_SIZE,\n      TILE_SIZE,\n      TILE_SIZE,\n      x,\n      y,\n      TILE_SIZE + incrementConst,\n      TILE_SIZE + incrementConst,\n    );\n\n    CTX.restore();\n\n  }\n\n  drawHead(x, y) {\n    const incrementConst = 6;\n\n    CTX.save();\n\n    x = x * TILE_SIZE - incrementConst / 2;\n    y = (y - 0.50) * TILE_SIZE - incrementConst / 2;\n\n    let spriteIndex = 0;\n    let stepAnimation = this.stepAnimation >= 8 ? 1 : 0;\n    let isReversed = false;\n    let stepAnimationShift = 0;\n\n    if (this.direction === 'UP') {\n      stepAnimationShift = 4;\n    }\n    if (this.direction === 'RIGHT') {\n      stepAnimationShift = 2;\n    }\n    if (this.direction === 'LEFT') {\n      stepAnimationShift = 2;\n      isReversed = true;\n    }\n\n\n\n    stepAnimation += stepAnimationShift;\n\n    if (isReversed) {\n      CTX.translate( x + TILE_SIZE, y);\n      CTX.scale(-1, 1);\n      x = 0;\n      y= 0\n    }\n\n    CTX.drawImage(\n      ISAAC_SPRITE,\n      stepAnimation * SPRITE_SIZE,\n      0,\n      TILE_SIZE,\n      TILE_SIZE,\n      x,\n      y,\n      TILE_SIZE + incrementConst,\n      TILE_SIZE + incrementConst,\n    );\n\n    CTX.restore();\n  }\n\n  incrementStepAnimation(timestamp){\n    this.stepAnimation++;\n    this.stepAnimation = this.stepAnimation % FRAMES_STEP;\n    this.stepAnimationTimeStamp = timestamp;\n  }\n\n  getProgressOfAnimation() {\n    let currentTimeStamp = new Date().getTime();\n    return (currentTimeStamp - this.animTimestamp) / ANIMATION_DURATION;\n  }\n}\n","import Board from \"./board\";\nimport {\n  CANVAS_ELEMENT,\n  CTX\n} from \"./canvas\";\nimport Boney from \"./ghost\";\nimport Pacman from \"./pacman\";\nimport Tile from \"./tile\";\n\nconst gameData = require(\"./data.json\");\nconst ENNEMIES_DATA = gameData.ennemiesData;\nconst DIRECTIONS = ['DOWN', 'UP', 'RIGHT', 'LEFT'];\n\nimport {\n  modulo,\n  DIRECTION_MATRICES,\n  addCoord,\n  distanceBetweenCoords\n} from \"./utils\";\n\nexport default class Game {\n  constructor() {\n    this.scoreElement = document.getElementById(\"score\");\n\n    this.score = 0;\n    // Possible state : STOPPED, START, GAME, CHASE\n    this.gameState = \"START\";\n\n    this.initGame();\n  }\n\n  initGame() {\n    this.board = new Board();\n    this.pacman = new Pacman();\n    this.boneys = this.initEnnemies();\n    this.state\n\n    this.draw();\n  }\n\n  startGameLoop() {\n    this.bindEventHandler();\n    window.requestAnimationFrame(this.loop.bind(this));\n  }\n\n  loop(timestamp) {\n    let progress = timestamp - this.lastRender;\n    this.lastRender = timestamp;\n\n    this.draw(progress, timestamp);\n    this.update(progress, timestamp);\n\n    window.requestAnimationFrame(this.loop.bind(this));\n  }\n\n  update(progress, timestamp) {\n    // Update the state of the world for the elapsed time since last render\n    this.updatePacman();\n    this.updateEnnemies(timestamp);\n  }\n  resou\n  draw(progress, timestamp) {\n    // Reinit the canvas\n    CTX.fillStyle = \"#2c2a2a\";\n    CTX.fillRect(0, 0, CANVAS_ELEMENT.width, CANVAS_ELEMENT.height);\n    // Update the state of the world for the elapsed time since last render\n    this.board.drawBoard();\n    this.pacman.draw(timestamp);\n    this.drawEnnemies(timestamp);\n  }\n\n  ////////////////////////////////////\n  // PACMAN\n  ////////////////////////////////////\n\n  updatePacman() {\n    // If animation still happening, leave\n    if (!this.pacman.isAnimationFinished()) {\n      return;\n    }\n\n    // ADD SCORE\n    this.addPointOfCurrentPacmanTile();\n    // If animation is still happening\n\n    let nextTile = this.computePathPacman();\n    if (nextTile) {\n      this.pacman.setMovingCoord(nextTile.coord);\n    } else {\n      // If no valid target tile, stop pacman\n      this.pacman.direction = \"\";\n      this.pacman.state = \"IDLE\";\n    }\n  }\n\n  computePathPacman() {\n    // If no direction given, leave\n    if (!this.pacman.direction && !this.pacman.isUserInputValid()) {\n      return;\n    }\n\n    // Get the next tile in the user given direction\n    let nextTileUserDirection = this.getNextTileInDirection(\n      this.pacman.currentCoord,\n      this.pacman.userInputDirection\n    );\n\n    // If the user direction is valid\n    if (nextTileUserDirection ?.tileType === \"PATH\") {\n      this.pacman.confirmUserDirection();\n      return nextTileUserDirection;\n    }\n\n    // Get the next tile in the initial direction\n    let nextTileCurrentDirection = this.getNextTileInDirection(\n      this.pacman.currentCoord,\n      this.pacman.direction\n    );\n\n    // If the initial direction is valid\n    if (nextTileCurrentDirection ?.tileType === \"PATH\") {\n      this.pacman.setMovingCoord(nextTileCurrentDirection.coord);\n      return nextTileCurrentDirection;\n    }\n  }\n\n  ////////////////////////////////////\n  // GHOSTS\n  ////////////////////////////////////\n  initEnnemies() {\n    const boneys = [];\n    ENNEMIES_DATA.forEach((ennemyData) => {\n      boneys.push(new Boney(ennemyData));\n    });\n    return boneys;\n  }\n\n  updateEnnemies(timestamp) {\n    this.boneys.forEach((boney) => {\n      this.updateEnnemy(boney, timestamp);\n    });\n  }\n\n  updateEnnemy(ennemy,timestamp) {\n    if (!ennemy.isAnimationFinished()) return;\n    if (!ennemy.canMove(timestamp)) return;\n\n    ennemy.updateState();\n\n    // get all possible tiles for the ennemy\n    const possibleTiles = this.getEnnemyPossibleTiles(ennemy);\n    if (possibleTiles.length > 1 && ennemy.state === 'CHASE') {\n      this.getTarget(ennemy);\n    }\n    // Compute what is the closest possible tile to the target coord\n    const tileToMove = this.computeNearestTileToTarget(ennemy, possibleTiles);\n    if (!tileToMove) return;\n\n    // Set the target coord\n    ennemy.setMovingCoord(tileToMove.coord);\n  }\n\n  getEnnemyPossibleTiles(ennemy) {\n    let currentCoord = ennemy.currentCoord;\n    // Ennemies can't go backwards\n    let possibleDirections = DIRECTIONS.filter((dir) => dir != ennemy.getOppositeDirection());\n    let adjacentTiles = possibleDirections.map((direction) => {\n      return this.getNextTileInDirection(currentCoord, direction);\n    });\n\n    return adjacentTiles.filter((tile) => {\n      return ennemy.isTilePossible(tile);\n    })\n  }\n\n  computeNearestTileToTarget(ennemy, possibleTiles) {\n    let targetCoord = ennemy.targetCoord;\n    let closestDistance = null;\n    let closestTile = null;\n\n    possibleTiles.forEach((tile) => {\n      let distance = distanceBetweenCoords(tile.coord, ennemy.targetCoord);\n      if (closestDistance === null || distance < closestDistance) {\n        closestDistance = distance;\n        closestTile = tile;\n      }\n    });\n    return closestTile;\n  }\n\n  getTarget(ennemy) {\n    if (!ennemy.state === 'CHASE') return;\n    ennemy.justSpawned = false;\n    ennemy.targetCoord = this.pacman.movingCoord;\n  }\n\n\n\n  drawEnnemies(timestamp) {\n    this.boneys.forEach((boney) => {\n      boney.draw(timestamp);\n    });\n  }\n\n\n  getNextTileInDirection(currentCoord, direction) {\n    if (!direction || !currentCoord) {\n      return false;\n    }\n\n    let directionMatrice = DIRECTION_MATRICES[direction];\n    let coordToMove = addCoord(directionMatrice, currentCoord);\n    return this.board.getTile(coordToMove);\n  }\n\n  addPointOfCurrentPacmanTile() {\n    let currentTile = this.board.getTile(this.pacman.currentCoord);\n\n    if (currentTile.hasPoint || currentTile.hasSuperPoint) {\n      this.addScore(10);\n      currentTile.removePoint();\n    }\n  }\n\n  addScore(value) {\n    this.score += value;\n    this.scoreElement.textContent = this.score;\n  }\n\n  bindEventHandler() {\n    document.addEventListener(\"keydown\", this.keydownEventHandler.bind(this));\n  }\n\n  unbindEventHandler() {\n    document.removeEventListener(\"keydown\", this.keydownEventHandler);\n  }\n\n  keydownEventHandler(event) {\n    let keycode = event.which;\n\n    // LEFT : ARROW_LEFT or Q\n    if (keycode === 37 || keycode === 81) {\n      this.pacman.setUserInputDirection(\"LEFT\");\n      event.preventDefault();\n    }\n    // RIGHT : ARROW_RIGHT or D\n    if (keycode === 39 || keycode === 68) {\n      this.pacman.setUserInputDirection(\"RIGHT\");\n    event.preventDefault();\n    }\n    // UP : ARROW_UP or Z\n    if (keycode === 38 || keycode === 90) {\n      this.pacman.setUserInputDirection(\"UP\");\n    event.preventDefault();\n    }\n    // DOWN : ARROW_DOWN or S\n    if (keycode === 40 || keycode === 83) {\n      this.pacman.setUserInputDirection(\"DOWN\");\n    event.preventDefault();\n    }\n  }\n}","import Game from \"./game\";\n\nfunction docReady(fn) {\n    // see if DOM is already available\n    if (document.readyState === \"complete\" || document.readyState === \"interactive\") {\n        // call on next available tick\n        setTimeout(fn, 1);\n    } else {\n        document.addEventListener(\"DOMContentLoaded\", fn);\n    }\n}    \n\n\ndocReady(()=>{\n    const game = new Game();\n    game.initGame();\n    game.startGameLoop();\n})\n\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}